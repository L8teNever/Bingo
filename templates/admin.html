{% extends "layout.html" %}

{% block content %}
<!-- Top App Bar -->
<header class="md-top-app-bar">
    <button class="md-icon-button" onclick="toggleDrawer()">
        <span class="material-symbols-rounded">menu</span>
    </button>
    <div class="md-top-app-bar-title">Admin Bereich</div>
    <div style="width: 48px;"></div>
</header>

<main
    style="flex: 1; display: flex; flex-direction: column; padding: var(--spacing-lg); overflow-y: auto; gap: var(--spacing-lg);">

    <!-- Game Settings Card -->
    <div class="md-card-elevated animate-in" style="padding: var(--spacing-xl);">
        <h3 class="md-label" style="margin-bottom: var(--spacing-lg);">Spielregeln</h3>
        <form method="POST" style="display: flex; flex-direction: column; gap: var(--spacing-lg);">

            <div class="md-input-container" style="margin-bottom: 0;">
                <label class="md-label">Startzeit (HH:MM)</label>
                <input type="text" name="notify_time" value="{{ settings.notify_time }}" class="md-input" required>
            </div>

            <div class="md-input-container" style="margin-bottom: 0;">
                <label class="md-label">Abstimmung/Lock (HH:MM)</label>
                <input type="text" name="dinner_time" value="{{ settings.dinner_time }}" class="md-input" required>
            </div>

            <div class="md-input-container" style="margin-bottom: 0;">
                <label class="md-label">Wort-Sperre (Tage)</label>
                <input type="number" name="cooldown_days" value="{{ settings.cooldown_days }}" class="md-input"
                    required>
            </div>

            <div class="md-input-container" style="margin-bottom: 0;">
                <label class="md-label">Max. Ã„nderungen</label>
                <input type="number" name="max_changes" value="{{ settings.max_changes }}" class="md-input" required>
            </div>

            <button type="submit" name="update_settings" class="md-button md-button-filled w-full"
                style="height: 48px;">
                <span class="material-symbols-rounded">save</span>
                <span>Einstellungen speichern</span>
            </button>
        </form>
    </div>

    <!-- User Management Card -->
    <div class="md-card animate-in" style="padding: var(--spacing-xl);">
        <h3 class="md-label" style="margin-bottom: var(--spacing-lg);">Benutzer & Punkte</h3>
        <div style="display: flex; flex-direction: column; gap: var(--spacing-md);">
            {% for user in users %}
            <div class="md-card-filled" style="padding: var(--spacing-lg);">
                <div
                    style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--spacing-md);">
                    <div>
                        <div style="font-weight: 500; font-size: 16px; margin-bottom: 4px;">
                            {{ user.username }}
                        </div>
                        <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                            <span class="md-chip" style="font-size: 12px; padding: 4px 8px; height: auto;">{{ user.role
                                }}</span>
                            <span class="text-primary font-medium" style="font-size: 14px;">{{ user.points }}
                                Punkte</span>
                        </div>
                    </div>
                </div>

                <form method="POST" style="display: flex; gap: var(--spacing-sm); align-items: center;">
                    <input type="hidden" name="user_id" value="{{ user.id }}">
                    <div style="flex: 1;">
                        <label class="md-label" style="margin-bottom: var(--spacing-xs);">Punkte setzen</label>
                        <input type="number" name="points" value="{{ user.points }}" class="md-input"
                            style="margin-bottom: 0;">
                    </div>
                    <button type="submit" name="reward_points" class="md-button md-button-tonal"
                        style="margin-top: 20px;">
                        <span class="material-symbols-rounded">check</span>
                        <span>Setzen</span>
                    </button>
                </form>
            </div>
            {% endfor %}
        </div>
    </div>
</main>
{% endblock %}